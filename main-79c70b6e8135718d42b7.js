(()=>{"use strict";var t={};function e(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function o(t){return e(t,Date.now())}function i(t){const e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new t.constructor(+t):"number"==typeof t||"[object Number]"===e||"string"==typeof t||"[object String]"===e?new Date(t):new Date(NaN)}function n(t){const e=i(t);return e.setHours(0,0,0,0),e}function r(t){return e=t,i=o(t),+n(e)==+n(i);var e,i}t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var o=t.g.document;if(!e&&o&&(o.currentScript&&"SCRIPT"===o.currentScript.tagName.toUpperCase()&&(e=o.currentScript.src),!e)){var i=o.getElementsByTagName("script");if(i.length)for(var n=i.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=i[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})();let s={};function c(){return s}function d(t,e){const o=c(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0,r=i(t),s=r.getDay(),d=(s<n?7:0)+s-n;return r.setDate(r.getDate()-d),r.setHours(0,0,0,0),r}function a(t,e){return function(t,e,o){return+d(t,o)==+d(e,o)}(t,o(t),e)}function l(t,o){return function(t,o){const n=i(t);return isNaN(o)?e(t,NaN):o?(n.setDate(n.getDate()+o),n):n}(t,-o)}function u(){return"id"+Math.random().toString(36).slice(2)}class p{constructor(t,e,o,i){this._title=t,this._description=e,this._dueDate=o,this._priority=i,this._completed=!1,this._id=u()}get title(){return this._title}set title(t){this._title=t,this.saveToLocalStorage()}get id(){return this._id}get description(){return this._description}set description(t){this._description=t,this.saveToLocalStorage()}get dueDate(){return this._dueDate}set dueDate(t){this._dueDate=t,this.saveToLocalStorage()}get priority(){return this._priority}set priority(t){this._priority=t,this.saveToLocalStorage()}get completed(){return this._completed}set completed(t){this._completed=t,this.saveToLocalStorage()}saveToLocalStorage(){const t=JSON.parse(localStorage.getItem("projectList"))||[],e=t.findIndex((t=>t._todos.some((t=>t._id===this._id))));if(-1!==e){const o=t[e]._todos.findIndex((t=>t._id===this._id));-1!==o?t[e]._todos[o]={...t[e]._todos[o],...this}:t[e]._todos.push(this)}else t.push({_todos:[this]});localStorage.setItem("projectList",JSON.stringify(t))}}class h{constructor(t){this._title=t,this._todos=[],this._id=u()}get title(){return this._title}set title(t){this._title=t,this.saveToLocalStorage()}get id(){return this._id}get todoList(){return this._todos}set todoList(t){this._todos=t,this.saveToLocalStorage()}deleteTodo(t){this.todoList=this.todoList.filter((e=>e.id!==t.id)),this.saveToLocalStorage()}addTodo(t){this.todoList=[...this.todoList,t],this.saveToLocalStorage()}saveToLocalStorage(){const t=JSON.parse(localStorage.getItem("projectList"))||[],e=t.findIndex((t=>t._id===this._id));-1!==e?t[e]={...t[e],...this}:t.push(this),localStorage.setItem("projectList",JSON.stringify(t))}}const m=t.p+"images/trash-40996a056d015a648343.svg",g=t.p+"images/plus-807c9e6a5b5e4ae10359.svg",L=document.getElementById("todo-list");let v;const f=t=>{v=t,E(t),T(t)},E=t=>{L.innerHTML="",t.todoList.forEach((e=>{L.append(_(e,t))}))},T=t=>{const e=document.getElementById("button-add-todo");"Today"!==t.title&&"This Week"!==t.title?e||(()=>{const t=document.querySelector("main"),e=document.createElement("button");e.id="button-add-todo";const o=document.createElement("img");o.src=g,o.alt="Add Todo";const i=document.createElement("p");i.textContent="Add Todo",t.appendChild(e),e.append(o,i),y(e)})():e&&e.remove()},y=t=>{t&&(t.removeEventListener("click",j),t.addEventListener("click",j))};function j(){let t=new p;v.addTodo(t),E(v)}const _=(t,e)=>{const o=document.createElement("button"),i=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),s=w(t,"high","medium","low"),c=D(t),d=x(t),a=I(t,d),l=P(s,c),u=N(t),p=S(o,t,e);return o.classList.add("todo"),o.append(i),i.classList.add("todo-main"),i.append(n,r),n.classList.add("todo-left"),r.classList.add("todo-right"),n.append(a,d),r.append(u,p),C(o,l),k(a,d,u,p,s,c),B(t,a,d,u,p,s,c),o},S=(t,e,o)=>{const i=document.createElement("img");return i.src=m,i.addEventListener("click",(()=>b(t,e,o))),i},b=(t,e)=>{M.deleteTodoFromAllProjects(e.id),L.removeChild(t)},k=(...t)=>{t.forEach((t=>{t.addEventListener("click",(t=>{t.stopPropagation()}))}))},w=(t,...e)=>{const o=document.createElement("select");return o.name="Priority",e.forEach((e=>{let i=document.createElement("option");i.value=e,t.priority===i.value&&(i.selected=!0),i.textContent=e.charAt(0).toUpperCase()+e.slice(1),o.appendChild(i),O(t,"click",[i,"priority"])})),o},D=t=>{const e=document.createElement("textarea");return e.value="",void 0!==t.description&&(e.value=t.description),e.placeholder="Description...",e},I=(t,e)=>{const o=document.createElement("input");return o.type="checkbox",o.checked=t.completed,!0===o.checked?e.style.textDecoration="line-through":e.style.textDecoration="none",o},x=t=>{const e=document.createElement("input");return e.placeholder="Enter something...",void 0===t.title?e.value="":e.value=t.title,e},N=t=>{const e=document.createElement("input");return e.type="date",e.id="due-date",e.value=t.dueDate||"",e},P=(t,e)=>{const o=document.createElement("div");return o.classList.add("todo-details"),o.append(t,e),o},C=(t,e)=>{t.addEventListener("click",(()=>{t.contains(e)?t.removeChild(e):t.appendChild(e)}))},O=(t,e,...o)=>{o.forEach((([o,i])=>{o.addEventListener(e,(()=>{t[i]=o.value}))}))},B=(t,e,o,i,n,r,s)=>{o.addEventListener("keydown",(t=>{"Enter"===t.key&&o.blur()})),e.addEventListener("click",(()=>{!0===e.checked?o.style.textDecoration="line-through":o.style.textDecoration="none",t.completed=e.checked})),O(t,"input",[s,"description"],[i,"dueDate"],[o,"title"]),k(e,o,i,n,r,s)},W=document.getElementById("button-add-project"),A=document.getElementById("projects-list");let J=document.getElementById("project-title");const M=new class{constructor(){this._projectList=this.loadLocalStorage()}get projectList(){return this._projectList}set projectList(t){this._projectList=t,this.saveToLocalStorage()}deleteProject(t){t.todoList.forEach((t=>{this.deleteTodoFromAllProjects(t.id)})),this.projectList=this.projectList.filter((e=>e.id!==t.id)),this.saveToLocalStorage()}addProject(t){this.projectList=[...this.projectList,t],this.saveToLocalStorage()}saveToLocalStorage(){localStorage.setItem("projectList",JSON.stringify(this.projectList))}loadLocalStorage(){return(JSON.parse(localStorage.getItem("projectList"))||[]).map((t=>{const e=Object.assign(new h,t);return e._todos=t._todos.map((t=>Object.assign(new p,t))),e}))}getTodoToday(){return this._projectList.flatMap((t=>t.todoList.filter((t=>r(i(t.dueDate))))))}getTodosThisWeek(){return this._projectList.flatMap((t=>t.todoList.filter((t=>a(l(i(t.dueDate),1))))))}findProjectByTodoId(t){return this._projectList.find((e=>e.todoList.some((e=>e.id===t))))}deleteTodoFromAllProjects(t){const e=this.findProjectByTodoId(t);e&&(e.deleteTodo({id:t}),this.saveToLocalStorage())}};W.addEventListener("click",(()=>{F()}));const F=()=>{const t=new h("Untitled");M.addProject(t),H()},H=()=>{A.innerHTML="",M.projectList.forEach((t=>{"Today"!==t.title&&"This Week"!==t.title&&"Inbox"!==t.title&&(t=>{const e=document.createElement("li"),o=document.createElement("button"),i=document.createElement("p"),n=document.createElement("img");n.src=m,e.classList.add("project"),i.textContent=t.title,A.append(e),e.append(o),o.append(i,n),k(o,n),o.addEventListener("click",(()=>$(t))),n.addEventListener("click",(()=>U(t,e)))})(t)}))};H();const U=(t,e)=>{M.deleteProject(t),A.removeChild(e),M.projectList.forEach((t=>{"Inbox"===t.title&&$(t)}))},$=t=>{if(J.textContent=t.title,(t=>{if(J.contentEditable="true","Inbox"===t.title||"Today"===t.title||"This Week"===t.title)return void(J.contentEditable="false");const e=J.cloneNode(!0);J.parentNode.replaceChild(e,J),J=e,e.addEventListener("keydown",(t=>{"Enter"===t.key&&e.blur()})),J.addEventListener("blur",(()=>{t.title=J.textContent,H(),$(t)}))})(t),"Today"===t.title){const t=M.getTodoToday();f({title:"Today",todoList:t})}else if("This Week"===t.title){const t=M.getTodosThisWeek();f({title:"This Week",todoList:t})}else f(t)},q=document.getElementById("button-inbox"),R=document.getElementById("button-today"),z=document.getElementById("button-week");let G=M.projectList.find((t=>"Inbox"===t.title)),K=M.projectList.find((t=>"Today"===t.title)),Q=M.projectList.find((t=>"This Week"===t.title));G||(G=new h("Inbox"),M.addProject(G)),K||(K=new h("Today"),M.addProject(K)),Q||(Q=new h("This Week"),M.addProject(Q)),q.addEventListener("click",(()=>$(G))),R.addEventListener("click",(()=>$(K))),z.addEventListener("click",(()=>$(Q))),M.projectList.forEach((t=>{"Inbox"===t.title&&$(t)}))})();